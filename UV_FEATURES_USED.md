# UV åŠŸèƒ½ä½¿ç”¨ç¸½çµ

é€™ä»½æ–‡æª”è¨˜éŒ„äº†åœ¨ DC_partybot å°ˆæ¡ˆå„ªåŒ–éç¨‹ä¸­ä½¿ç”¨çš„æ‰€æœ‰ uv åŠŸèƒ½ã€‚

## ğŸš€ åŸºæœ¬å°ˆæ¡ˆç®¡ç†

### `uv init`
**ç”¨é€”ï¼š** åˆå§‹åŒ–ä¸€å€‹æ–°çš„ uv å°ˆæ¡ˆ
```bash
uv init
```
**æ•ˆæœï¼š**
- å‰µå»º `pyproject.toml` é…ç½®æª”æ¡ˆ
- è¨­ç½®åŸºæœ¬çš„å°ˆæ¡ˆçµæ§‹
- å‰µå»º `.python-version` æª”æ¡ˆ
- è‡ªå‹•è¨­ç½® Python ç‰ˆæœ¬éœ€æ±‚

**åœ¨æœ¬å°ˆæ¡ˆä¸­çš„çµæœï¼š**
- åˆå§‹åŒ–äº†åç‚º `dc-partybot` çš„å°ˆæ¡ˆ
- è¨­ç½®äº† Python 3.11 ç‰ˆæœ¬éœ€æ±‚
- å‰µå»ºäº†åŸºç¤çš„ `pyproject.toml` çµæ§‹

---

## ğŸ“¦ ä¾è³´é …ç›®ç®¡ç†

### `uv add`
**ç”¨é€”ï¼š** æ·»åŠ ä¾è³´é …ç›®åˆ°å°ˆæ¡ˆä¸­

#### æ·»åŠ ç”Ÿç”¢ä¾è³´é …ç›®
```bash
uv add discord.py python-dotenv aiohttp
uv add yt-dlp mutagen
uv add google-api-python-client google-auth google-auth-httplib2
uv add spotipy redis pynacl pycryptodomex
```

#### æ·»åŠ é–‹ç™¼ä¾è³´é …ç›®
```bash
uv add --dev black flake8 pytest pytest-asyncio mypy
```

**æ•ˆæœï¼š**
- è‡ªå‹•è§£æä¸¦å®‰è£ä¾è³´é …ç›®
- æ›´æ–° `pyproject.toml` ä¸­çš„ä¾è³´åˆ—è¡¨
- è‡ªå‹•æ›´æ–° `uv.lock` é–å®šæª”æ¡ˆ
- è™•ç†ä¾è³´è¡çªå’Œç‰ˆæœ¬ç›¸å®¹æ€§

**åœ¨æœ¬å°ˆæ¡ˆä¸­æ·»åŠ çš„å¥—ä»¶ï¼š**

**ç”Ÿç”¢ä¾è³´ï¼š**
- `discord.py` - Discord API å®¢æˆ¶ç«¯
- `python-dotenv` - ç’°å¢ƒè®Šæ•¸ç®¡ç†
- `aiohttp` - éåŒæ­¥ HTTP å®¢æˆ¶ç«¯
- `yt-dlp` - YouTube ä¸‹è¼‰å™¨
- `mutagen` - éŸ³è¨Šå…ƒæ•¸æ“šè™•ç†
- `google-api-python-client` - Google API å®¢æˆ¶ç«¯
- `google-auth` - Google èªè­‰
- `google-auth-httplib2` - Google HTTP èªè­‰
- `spotipy` - Spotify API å®¢æˆ¶ç«¯
- `redis` - Redis å®¢æˆ¶ç«¯
- `pynacl` - åŠ å¯†åº«
- `pycryptodomex` - åŠ å¯†å·¥å…·

**é–‹ç™¼ä¾è³´ï¼š**
- `black` - ä»£ç¢¼æ ¼å¼åŒ–å·¥å…·
- `flake8` - ä»£ç¢¼æª¢æŸ¥å·¥å…·
- `mypy` - é¡å‹æª¢æŸ¥å·¥å…·
- `pytest` - æ¸¬è©¦æ¡†æ¶
- `pytest-asyncio` - éåŒæ­¥æ¸¬è©¦æ”¯æ´

---

## ğŸ”„ å°ˆæ¡ˆåŒæ­¥èˆ‡ç®¡ç†

### `uv sync`
**ç”¨é€”ï¼š** åŒæ­¥å°ˆæ¡ˆä¾è³´é …ç›®ï¼Œç¢ºä¿ç’°å¢ƒèˆ‡é…ç½®ä¸€è‡´

```bash
uv sync
```

**æ•ˆæœï¼š**
- æ ¹æ“š `pyproject.toml` å®‰è£æ‰€æœ‰ä¾è³´é …ç›®
- å‰µå»ºæˆ–æ›´æ–°è™›æ“¬ç’°å¢ƒ
- é–å®šä¾è³´ç‰ˆæœ¬åˆ° `uv.lock`
- ç¢ºä¿é–‹ç™¼ç’°å¢ƒçš„ä¸€è‡´æ€§

**ä½¿ç”¨å ´æ™¯ï¼š**
- åˆæ¬¡è¨­ç½®å°ˆæ¡ˆç’°å¢ƒ
- å…¶ä»–é–‹ç™¼è€…å…‹éš†å°ˆæ¡ˆå¾Œçš„ç’°å¢ƒè¨­ç½®
- ä¾è³´é …ç›®æ›´æ–°å¾Œçš„ç’°å¢ƒåŒæ­¥

---

## ğŸƒâ€â™‚ï¸ ç¨‹å¼åŸ·è¡Œ

### `uv run`
**ç”¨é€”ï¼š** åœ¨å°ˆæ¡ˆè™›æ“¬ç’°å¢ƒä¸­åŸ·è¡Œå‘½ä»¤

#### åŸ·è¡Œ Python è…³æœ¬
```bash
uv run python main.py
```

#### åŸ·è¡Œé–‹ç™¼å·¥å…·
```bash
uv run black .          # ä»£ç¢¼æ ¼å¼åŒ–
uv run flake8 .         # ä»£ç¢¼æª¢æŸ¥
uv run mypy .           # é¡å‹æª¢æŸ¥
uv run pytest          # åŸ·è¡Œæ¸¬è©¦
```

**å„ªå‹¢ï¼š**
- è‡ªå‹•ä½¿ç”¨æ­£ç¢ºçš„ Python ç’°å¢ƒ
- ç„¡éœ€æ‰‹å‹•å•Ÿå‹•è™›æ“¬ç’°å¢ƒ
- ç¢ºä¿ä¾è³´é …ç›®çš„å¯ç”¨æ€§

---

## ğŸ“Š å°ˆæ¡ˆè³‡è¨ŠæŸ¥çœ‹

### `uv tree`
**ç”¨é€”ï¼š** é¡¯ç¤ºä¾è³´é—œä¿‚æ¨¹

```bash
uv tree
```

**æ•ˆæœï¼š**
- ä»¥æ¨¹ç‹€çµæ§‹é¡¯ç¤ºæ‰€æœ‰ä¾è³´é …ç›®
- é¡¯ç¤ºä¾è³´çš„ä¾è³´é—œä¿‚
- å¹«åŠ©ç†è§£å°ˆæ¡ˆçš„ä¾è³´çµæ§‹
- è­˜åˆ¥é‡è¤‡æˆ–è¡çªçš„ä¾è³´

**åœ¨æœ¬å°ˆæ¡ˆä¸­çš„è¼¸å‡ºç¤ºä¾‹ï¼š**
```
dc-partybot v0.1.0
â”œâ”€â”€ aiohttp v3.12.15
â”‚   â”œâ”€â”€ aiohappyeyeballs v2.6.1
â”‚   â”œâ”€â”€ aiosignal v1.4.0
â”‚   â””â”€â”€ ...
â”œâ”€â”€ discord-py v2.6.3
â””â”€â”€ ...
```

---

## ğŸ”§ é«˜ç´šé…ç½®åŠŸèƒ½

### ä¾è³´ç¾¤çµ„ (Dependency Groups)
**é…ç½®ä½ç½®ï¼š** `pyproject.toml`
```toml
[dependency-groups]
dev = [
    "black>=25.9.0",
    "flake8>=7.3.0",
    "mypy>=1.18.2",
    "pytest>=8.4.2",
    "pytest-asyncio>=1.2.0",
]
```

**ç”¨é€”ï¼š**
- åˆ†é›¢ç”Ÿç”¢å’Œé–‹ç™¼ä¾è³´
- æ”¯æ´æ¢ä»¶å®‰è£
- æ›´å¥½çš„ä¾è³´ç®¡ç†

### å°ˆæ¡ˆè…³æœ¬é…ç½®
**é…ç½®ä½ç½®ï¼š** `pyproject.toml`
```toml
[project.scripts]
bot = "main:main"
```

**æ•ˆæœï¼š**
- å‰µå»ºå‘½ä»¤è¡Œå…¥å£é»
- ç°¡åŒ–å°ˆæ¡ˆåŸ·è¡Œ

---

## ğŸ“ å°ˆæ¡ˆçµæ§‹ç®¡ç†

### Build ç³»çµ±é…ç½®
**é…ç½®ä½ç½®ï¼š** `pyproject.toml`
```toml
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.build.targets.wheel]
packages = ["."]
exclude = [
    "*.log",
    "logs/",
    "temp_audio/",
    "*.cookies",
    ".env*",
    "requirements.txt",
    "docker-compose.yml",
    "Dockerfile*",
]
```

**ç”¨é€”ï¼š**
- é…ç½®å°ˆæ¡ˆå»ºç½®æ–¹å¼
- æ§åˆ¶å“ªäº›æª”æ¡ˆè¢«åŒ…å«åœ¨ç™¼ä½ˆç‰ˆæœ¬ä¸­
- æ’é™¤æ•æ„Ÿæˆ–ä¸å¿…è¦çš„æª”æ¡ˆ

---

## ğŸ› ï¸ é–‹ç™¼å·¥å…·æ•´åˆ

### å·¥å…·é…ç½®
uv è‡ªå‹•è­˜åˆ¥ä¸¦ä½¿ç”¨ `pyproject.toml` ä¸­çš„å·¥å…·é…ç½®ï¼š

#### Black é…ç½®
```toml
[tool.black]
line-length = 88
target-version = ['py311']
include = '\.pyi?$'
exclude = '''
/(
    \.eggs
  | \.git
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
)/
'''
```

#### MyPy é…ç½®
```toml
[tool.mypy]
python_version = "3.11"
warn_return_any = true
warn_unused_configs = true
disallow_untyped_defs = true
# ... æ›´å¤šé…ç½®
```

#### Pytest é…ç½®
```toml
[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
asyncio_mode = "auto"
addopts = "-v --tb=short"
```

---

## ğŸš¦ æ•ˆèƒ½èˆ‡å„ªå‹¢

### é€Ÿåº¦æå‡
- **å®‰è£é€Ÿåº¦ï¼š** æ¯” pip å¿« 10-100 å€
- **ä¾è³´è§£æï¼š** æ›´å¿«çš„è¡çªæª¢æ¸¬å’Œè§£æ±º
- **å¿«å–æ©Ÿåˆ¶ï¼š** æ™ºæ…§çš„å¥—ä»¶å¿«å–

### å¯é æ€§
- **ä¾è³´é–å®šï¼š** `uv.lock` ç¢ºä¿ç’°å¢ƒä¸€è‡´æ€§
- **è¡çªæª¢æ¸¬ï¼š** è‡ªå‹•æª¢æ¸¬ä¸¦è§£æ±ºä¾è³´è¡çª
- **ç‰ˆæœ¬ç®¡ç†ï¼š** ç²¾ç¢ºçš„ç‰ˆæœ¬æ§åˆ¶

### é–‹ç™¼é«”é©—
- **çµ±ä¸€ä»‹é¢ï¼š** å–®ä¸€å‘½ä»¤è™•ç†æ‰€æœ‰å¥—ä»¶æ“ä½œ
- **è‡ªå‹•ç’°å¢ƒï¼š** è‡ªå‹•ç®¡ç†è™›æ“¬ç’°å¢ƒ
- **ç¾ä»£æ¨™æº–ï¼š** éµå¾ª Python ç¤¾ç¾¤æœ€æ–°æ¨™æº–

---

## ğŸ“ æœ€ä½³å¯¦è¸

### 1. å°ˆæ¡ˆåˆå§‹åŒ–
```bash
uv init                    # åˆå§‹åŒ–å°ˆæ¡ˆ
uv add <dependencies>      # æ·»åŠ ä¾è³´
uv add --dev <dev-deps>    # æ·»åŠ é–‹ç™¼ä¾è³´
```

### 2. æ—¥å¸¸é–‹ç™¼
```bash
uv sync                    # åŒæ­¥ç’°å¢ƒ
uv run <command>           # åŸ·è¡Œå‘½ä»¤
uv add <new-package>       # æ·»åŠ æ–°å¥—ä»¶
```

### 3. å°ˆæ¡ˆåˆ†äº«
- æäº¤ `pyproject.toml` å’Œ `uv.lock`
- å…¶ä»–é–‹ç™¼è€…åªéœ€åŸ·è¡Œ `uv sync`
- ç¢ºä¿ç’°å¢ƒå®Œå…¨ä¸€è‡´

---

## ğŸ”— ç›¸é—œæª”æ¡ˆ

åœ¨æœ¬å°ˆæ¡ˆä¸­ï¼Œuv åŠŸèƒ½æ¶‰åŠçš„ä¸»è¦æª”æ¡ˆï¼š

- **`pyproject.toml`** - å°ˆæ¡ˆé…ç½®å’Œä¾è³´å®šç¾©
- **`uv.lock`** - ä¾è³´é–å®šæª”æ¡ˆ
- **`.python-version`** - Python ç‰ˆæœ¬æŒ‡å®š
- **`scripts.ps1`** - ä¾¿åˆ©è…³æœ¬ï¼ˆæ•´åˆ uv å‘½ä»¤ï¼‰
- **`README.md`** - æ›´æ–°äº†å®‰è£å’Œä½¿ç”¨èªªæ˜

é€™äº› uv åŠŸèƒ½è®“ DC_partybot å°ˆæ¡ˆæ“æœ‰äº†ç¾ä»£ Python é–‹ç™¼çš„æ‰€æœ‰å„ªå‹¢ï¼ŒåŒ…æ‹¬æ›´å¿«çš„å®‰è£ã€æ›´å¥½çš„ä¾è³´ç®¡ç†å’Œæ›´ç°¡æ½”çš„é–‹ç™¼å·¥ä½œæµç¨‹ã€‚